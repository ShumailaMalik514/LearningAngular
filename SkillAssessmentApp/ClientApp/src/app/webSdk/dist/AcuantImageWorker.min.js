"use strict";importScripts("AcuantImageService.min.js"),AcuantImageModule().then((e=>{let a=e.addFunction(n,"viiiii"),r=e.addFunction(s,"viiiiiiiii"),t=e.addFunction(c,"vii"),i=e.addFunction(l,"vi");function n(a,r,t,i,n){let s={func:"crop"};if(t>=0){const c=new ArrayBuffer(r);let l=new Uint8Array(c);l.set(e.HEAPU8.subarray(a,a+r),0),s.imgData=l,s.width=t,s.height=i,s.type=n}else switch(t){case-1:s.error="Runtime error.";break;case-2:s.error="Detect (for cropping) did not return OK";break;case-3:s.error="Crop did not return OK";break;default:s.error="Unknown Error Occured"}s&&s.imgData&&s.imgData.buffer?postMessage(s,[s.imgData.buffer]):postMessage(s)}function s(e,a,r,t,i,n,s,c,l){let o={func:"detect"};if(a>=0)o.type=e,o.x1=a,o.y1=r,o.x2=t,o.y2=i,o.x3=n,o.y3=s,o.x4=c,o.y4=l;else switch(a){case-1:o.error="Runtime error.";break;case-2:o.error="Detect did not return OK";break;default:o.error="Unknown Error Occured"}postMessage(o)}function c(a,r){let t={func:"sign"};if(a){const i=new ArrayBuffer(r);let n=new Uint8Array(i);n.set(e.HEAPU8.subarray(a,a+r),0),t.imgData=n}else switch(r){case-1:t.error="Failed to sign image: SIGN_PARSE_ERROR";break;case-2:t.error="Failed to sign image: SIGN_CANNOT_SIGN";break;case-3:t.error="Failed to sign image: SIGN_HASH_ERROR";break;default:t.error="Failed to sign image: UNEXPECTED"}postMessage(t)}function l(e){postMessage({func:"verify",result:e})}function o(a){null!=a&&(e._free(a),a=null)}function u(a){var r=e._malloc(a.length*a.BYTES_PER_ELEMENT);return e.HEAPU8.set(a,r),r}onmessage=g=>{if(g&&g.data)if("crop"===g.data.func){let r=g.data.data;if(r.imgData&&r.width&&r.height){let t=u(r.imgData);e.ccall("acuantCrop",null,["number","number","number","number"],[t,r.width,r.height,a]),o(t)}else console.error("missing params"),n(-1,-1,-1,-1)}else if("detect"===g.data.func){let a=g.data.data;if(a.imgData&&a.width&&a.height){let t=u(a.imgData);e.ccall("acuantDetect",null,["number","number","number","number"],[t,a.width,a.height,r]),o(t)}else console.error("missing params"),s(-1,-1,-1,-1,-1,-1,-1,-1,-1)}else if("sign"===g.data.func){let a=g.data.data;if(a.imgData){let r=u(a.imgData);e.ccall("acuantSign",null,["number","number","number"],[r,a.imgData.byteLength,t]),o(r)}else console.error("missing params"),c(null,-1)}else if("verify"==g.data.func){let a=g.data.data;if(a.imgData){let r=u(a.imgData);e.ccall("acuantVerify",null,["number","number","number"],[r,a.imgData.byteLength,i]),o(r)}else console.log("missing params"),l(null)}else console.error("called with no func specified")},postMessage({imageWorker:"started"})}));